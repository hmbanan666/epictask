Поработаем с материалами, начнем с Задач. Нужно придумать простой способ хранения текста Задачи. Чтобы при написании статьи
можно было делать текст жирным, курсивом, подчеркивать, делать списки и т.д. При этом, чтобы не было проблем с сохранением
в базу данных.

Стоп, не надо придумывать. Есть Markdown. Это простой язык разметки, который позволяет делать все, что нужно для
написания статей. И в базе данных можно хранить просто текст, а не html.

Я выбрал библиотеку marked.

```
npm i marked
npm i -D @types/marked
```

Для работы на сайте достаточно просто вызвать функцию marked и передать ей текст. Она вернет html.

```
import { marked } from 'marked';
const html = marked.parse(text);

< dangerouslySetInnerHTML={{ __html: html }} />
```

Да, выглядит с точки зрения безопасности и производительности не очень. Но пока сойдет. Текста, которые были хардкодом
в html, я перенес в отдельный файл.

## tRPC – делаем запросы на сервер

Так как Next.js позволяет вызывать функции на сервере, то почему бы не развернуть API, прямо тут? Чтобы не делать вручную
файлы-обработчики (routes) в папке api (как предлагается в документации Next.js), я выбрал библиотеку tRPC.

Главные преимущества, на мой взгляд:
- автоматически генерирует routes
- автоматически генерирует типы
- удобнее, чем тот же REST
- все что внутри функции, выполняется строго на сервере
- легко защитить функции от тех, кто не авторизован на сайте (у кого нет сессии)
- легко вызывать и применять данные в React компонентах

Вся сложная логика tRPC спрятана в файл utils/api.ts. Оттуда мы импортируем в нужном месте константу api. В папке server/api 
у нас есть роутеры (делаем новый по аналогии с example.ts). Их подключаем в root.ts 

Делаем итоговые запросы в компонентах примерно так:

```
import { api } from '../../utils/api';

const { data: task } = api.data.task.useQuery({ id });
```

Тогда в константе task по итогу будет Задача с нужным id.

## Что дальше?

Так как есть возможность запускать код на сервере, то можно подключить базу данных прямо здесь. Как вариант PostgreSQL.
Пользователи никак не смогут обратиться к БД напрямую, даже увидеть запросы. Весь процесс на сервере, под защитой.

Скоро будет новый пост. Спасибо за внимание!
